report:
  name: reports.aws.rds.events
  description: This report provides information on RDS Events across all regions and accounts.

  headers:
    - Account
    - Region
    - Date
    - Identifier
    - Type
    - Message

  tasks:
    - mongo:
        name: get rds events
        silo: harvest-core
        collection: aws.rds.events
        filters: '.*'

        arguments:
          pipeline:
            - $project:
                Active: "$Harvest.Active"
                Date:
                  $dateToString:
                    date: "$Date"
                Account: "$Harvest.Account"
                Region: "$Harvest.Region"
                Identifier: "$SourceIdentifier"
                Type: "$SourceType"
                Message: "$Message"
